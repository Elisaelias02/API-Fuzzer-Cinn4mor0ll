targets:
  - name: "crAPI - Vulnerable API"
    base_url: "http://localhost:8888"
    enabled: true
    
    users:
      - name: "alice"
        id: "101"
        token: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMDEiLCJuYW1lIjoiQWxpY2UiLCJyb2xlIjoidXNlciIsImV4cCI6MTc0MDAwMDAwMH0.secret123"
        role: "user"
      
      - name: "bob"
        id: "102"
        token: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMDIiLCJuYW1lIjoiQm9iIiwicm9sZSI6InVzZXIifQ.secret123"
        role: "user"
      
      - name: "admin"
        id: "1"
        token: "Bearer eyJhbGciOiJub25lIn0.eyJzdWIiOiIxIiwibmFtZSI6IkFkbWluIiwicm9sZSI6ImFkbWluIn0."
        role: "admin"
    
    endpoints:
      # BOLA Tests
      - path: "/api/v1/users/{id}/profile"
        methods: ["GET"]
        auth_required: true
        test_modules: ["bola_detector", "data_exposure_detector"]
      
      - path: "/api/v1/orders/{id}"
        methods: ["GET"]
        auth_required: true
        test_modules: ["bola_detector", "data_exposure_detector"]
      
      # Auth Tests
      - path: "/api/v1/auth/login"
        methods: ["POST"]
        auth_required: false
        test_modules: ["auth_detector"]
      
      - path: "/api/v1/auth/register"
        methods: ["POST"]
        auth_required: false
        test_modules: ["auth_detector"]
      
      # Data Exposure Tests
      - path: "/api/v1/users"
        methods: ["GET"]
        auth_required: true
        test_modules: ["data_exposure_detector"]
      
      - path: "/api/v1/users/me"
        methods: ["GET"]
        auth_required: true
        test_modules: ["data_exposure_detector", "auth_detector"]
